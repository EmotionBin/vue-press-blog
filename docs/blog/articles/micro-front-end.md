# 微前端

本文来聊一聊微前端，其实这篇文章很早就打算写了，但是一直没有时间，趁最近这段时间不算太忙，挤了点时间写这篇文章

---

## 微前端是什么

微前端的概念其实是从后端的微服务概念引申出来的，先来了解一下什么是微服务架构

> 微服务是面向服务架构（SOA）的一种变体，把应用程序设计成一系列松耦合的细粒度服务，并通过轻量级的通信协议组织起来
> 具体地，将应用构建成一组小型服务。这些服务都能够独立部署、独立扩展，每个服务都具有稳固的模块边界，甚至允许使用不同的编程语言来编写不同服务，也可以由不同的团队来管理

然而，越来越重的前端工程也面临同样的问题，自然地想到了将微服务思想应用到前端，于是有了微前端的概念，这里引用阿里微前端框架[乾坤](https://qiankun.umijs.org/zh/guide)官网的一句话

> Techniques, strategies and recipes for building a modern web app with multiple teams that can ship features independently. -- Micro Frontends  
> 微前端是一种多个团队通过独立发布功能的方式来共同构建现代化 web 应用的技术手段及方法策略。

单纯看微前端的概念可能会比较抽象，没关系，接下来我们来一起慢慢了解

简单来说，微前端架构对外部只暴露一个容器，只有一个应用的入口，通过对路由的分发控制，以匹配渲染子应用，下面来看一张图

[![5gLEmn.png](https://z3.ax1x.com/2021/10/23/5gLEmn.png)](https://z3.ax1x.com/2021/10/23/5gLEmn.png)

从上图可以看到，微前端对外部暴露了一个主应用，它的入口是 `www.base.com`，通过访问 `www.base.com` 以进入主应用，主应用中又接入了下面五个子应用，这些子应用都是独立部署的，他们都是具有**沙箱隔离**的特性的，也就是说，每个子应用互不影响，而且他们还可以是不同的技术栈!主应用通过路由分发控制访问子应用，比如访问 `www.base.com/app1` 渲染 app1，访问 `www.base.com/app2` 渲染 app2 等等

我自己写了一个简单的 demo，可以看这里 [传送门](https://github.com/EmotionBin/qiankun-demo)

---

## 微前端解决了什么问题

一个项目在前期的时候可能并不是那么复杂，但是随着项目的迭代，项目的规模可能会越来越庞大，越来越复杂，甚至还有可能会接入别的应用

如果一个庞大的项目不进行拆分，那么它维护起来可能会很吃力，微前端就是解决了这个问题，将庞大的应用先拆分成若干个子应用，最后再组合在一起

有人可能会说，用 `iframe` 可以拆分成多个子应用。确实，这是可以的，但是用过 `iframe` 的伙伴都知道，它非常的慢，每次都需要加载整个页面的所有东西，这里有一个可以很好的代替 `iframe` 的解决方案，它就是阿里打造的微前端框架 [乾坤](https://qiankun.umijs.org/zh)

---

## 微前端的优势在哪里

- 每个子应用都是一个独立的容器，具有沙箱隔离的特性，并且子应用可以使用任意技术栈，子应用独立部署
- 简单、松耦合的代码库，子应用都相对比较简单，易于维护，相互依赖的程度低，松耦合
- 子应用可以接入其他团队的应用，这为项目的扩展提供了很大的便利，渐进地升级、更新甚至重写部分前端功能成为了可能

如果使用了[乾坤](https://qiankun.umijs.org/zh)框架来搭建微前端架构，你可以得到比使用 `iframe` 更好的体验，为什么[乾坤](https://qiankun.umijs.org/zh)能比 `iframe` 优秀呢，可以看这里 [Why Not Iframe](https://www.yuque.com/kuitos/gky7yw/gesexv)

---

## 一些容易踩坑的地方(使用乾坤框架)

我个人自己写了个 demo 来实践了乾坤框架，遇到了以下的坑点：

1.子应用静态资源打包后 404

这是因为路径的问题，将子应用静态资源打包成绝对路径即可，这只是其中的一种解决方案，更多方案看这里 [为什么微应用加载的资源会 404？](https://qiankun.umijs.org/zh/faq#%E4%B8%BA%E4%BB%80%E4%B9%88%E5%BE%AE%E5%BA%94%E7%94%A8%E5%8A%A0%E8%BD%BD%E7%9A%84%E8%B5%84%E6%BA%90%E4%BC%9A-404)

如果遇到了其他问题，可以第一时间查阅乾坤的官方文档 [常见问题](https://qiankun.umijs.org/zh/faq)
